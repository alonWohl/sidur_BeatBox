import{j as e,T as t,a as r,b as n,c as s,d as o,e as a}from"./ui-Dy97XmpM.js";import{u as i,a as l}from"./dnd-CPfeyw_i.js";import{a as c}from"./vendor-DN4hhbqm.js";const d=["ראשון","שני","שלישי","רביעי","חמישי","שישי","שבת"],m=["morning","noon","evening"],p={morning:"בוקר",noon:"אמצע",evening:"ערב"},u={manager:{name:'אחמ"ש',positions:1},waiters:{name:"מלצרים",positions:5},cooks:{name:"טבחים",positions:6}};function x({id:t,employee:r,onRemove:n}){const{setNodeRef:s,isOver:o}=i({id:t,data:{type:"cell",cellId:t}}),{attributes:a,listeners:c,setNodeRef:d,isDragging:m}=l({id:`draggable-${t}`,data:{type:"tableCell",cellId:t,employee:r},disabled:!r}),p={...c,onMouseDown:e=>{let r=!1;const s=setTimeout((()=>{r=!0,c.onMouseDown(e)}),150),o=()=>{r||n(t),clearTimeout(s),window.removeEventListener("mouseup",o)};window.addEventListener("mouseup",o)}};return e.jsxs("div",{ref:e=>{s(e),r&&d(e)},...a,...p,className:`h-8 w-full border border-gray-200 relative\n        flex items-center justify-center text-white truncate px-1\n        ${o?"ring-2 ring-blue-400 bg-blue-50":""}\n        ${r?"cursor-pointer group":""}`,style:{backgroundColor:(null==r?void 0:r.color)||"transparent",opacity:m?0:1},children:[e.jsx("div",{className:"absolute inset-0 bg-white/50 opacity-0 group-hover:opacity-100 transition-opacity"}),!m&&e.jsx("span",{className:"relative z-10 group-hover:hidden",children:null==r?void 0:r.name}),!m&&r&&e.jsx("span",{className:"relative z-10 hidden group-hover:block text-sm  ",children:"לחץ להסרה"})]})}const h=c.memo((function({type:i,currentSchedule:l,getAssignedEmployee:c,handleRemoveEmployee:h}){const g="מוקד"===i,b=g?4:null,y=(t,r,n)=>{const s=`${t}-${r}-${n}`,o=c(l,t,r,n);return e.jsx(x,{id:s,employee:o,onRemove:()=>h(l,t,r,n)},s)};return e.jsx("div",{className:"overflow-auto touch-pan-x touch-pan-y -mx-4 px-4",children:e.jsx("div",{id:"schedule-table-for-share",children:e.jsxs(t,{className:"w-full table-fixed min-w-[640px]",children:[e.jsx(r,{children:e.jsxs(n,{children:[e.jsx(s,{className:"text-center border-x bg-[#BE202E]/50 text-white w-[80px]",children:g?"משמרות":"תפקידים"}),d.map((t=>e.jsx(s,{className:"text-center border-x border-b even:bg-[#BE202E] even:text-white \n                      odd:bg-[#BE202E]/50 text-white w-[80px]",children:t},t)))]})}),g?e.jsx(o,{children:m.flatMap((t=>Array.from({length:b},((r,s)=>{const o=s+1;return e.jsxs(n,{className:"h-10",children:[e.jsx(a,{className:"text-center font-medium border-l border text-sm p-1 w-[80px]\n                    "+(1===o?"bg-[#BE202E] text-white":"border-t-0 bg-[#BE202E]/50"),children:1===o?p[t]:""}),d.map((r=>e.jsx(a,{className:"p-2 w-[80px] "+(1===o?"":"border-t-0"),children:y(r,t,o)},`${r}-${t}-${o}`)))]},`${t}-${o}`)}))))}):e.jsx(o,{children:Object.entries(u).flatMap((([t,r])=>Array.from({length:r.positions},((s,o)=>{const i=o+1;return e.jsxs(n,{className:"h-10",children:[e.jsx(a,{className:"text-center font-medium border-l border text-sm p-1 w-[80px] max-w-[80px]\n                    "+(1===i?"bg-[#BE202E] text-white":"border-t-0 bg-[#BE202E]/50"),children:1===i?r.name:""}),d.map((r=>e.jsx(a,{className:"p-2 w-[80px] "+(1===i?"":"border-t-0"),children:y(r,t,i)},`${r}-${t}-${i}`)))]},`${t}-${i}`)}))))})]})})})}),((e,t)=>{var r,n;return!(e.type!==t.type||e.currentSchedule!==t.currentSchedule||JSON.stringify(null==(r=e.currentSchedule)?void 0:r.days)!==JSON.stringify(null==(n=t.currentSchedule)?void 0:n.days))}));function g({employee:t}){const{attributes:r,listeners:n,setNodeRef:s,isDragging:o}=l({id:t.id,data:{type:"employee",employee:t}});return e.jsx("div",{ref:s,...n,...r,className:"p-2 sm:p-3 rounded cursor-grab active:cursor-grabbing \n        text-sm sm:text-base w-20 sm:w-24 text-center touch-manipulation \n        select-none text-white transition-all duration-200 hover:brightness-90\n        truncate",style:{backgroundColor:t.color,opacity:o?0:1,WebkitTapHighlightColor:"transparent"},children:!o&&t.name})}function b({employees:t}){return e.jsx("div",{className:"flex flex-wrap gap-1.5 sm:gap-2 w-full items-center justify-center",children:t.map((t=>e.jsx(g,{employee:t},t.id)))})}export{b as E,h as S};
